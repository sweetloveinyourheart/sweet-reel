syntax = "proto3";

package com.sweetloveinyourheart.srl.auth;

option go_package = "github.com/sweetloveinyourheart/sweet-reel/proto/code/auth/go;grpc";

// AuthService handles all authentication-related logic.
service AuthService {
    // Handles OAuth login with external providers (Google, GitHub, etc.)
    rpc OAuthLogin(OAuthLoginRequest) returns (OAuthLoginResponse);

    // Handle refresh tokens.
    rpc RefreshToken(RefreshTokenRequest) returns (RefreshTokenResponse);
}

// ===== Messages =====

message OAuthLoginRequest {
    string provider = 1;        // "google", "github", ...
    string access_token = 2;    // token from provider
}

message User {
    string id = 1;
    string email = 2;
    string name = 3;
    string picture = 4;
    string created_at = 5;
    string updated_at = 6;
}

message OAuthLoginResponse {
    User user = 1;
    string jwt_token = 2;
    string jwt_refresh_token = 3;
    bool is_new_user = 4;
}

message RefreshTokenRequest {
    string jwt_refresh_token = 1;
}

message RefreshTokenResponse {
    string jwt_token = 1;
}
